I am currently working on a SCD Type 2 library and applying it to track the changes of employee data. 
data_archiving.py and clean_start.py are two files that store the function/library
usage.py is the file showing how I use the functions in data_archiving.py and clean_start.py 
Note here for usage, we have one input and one output that show when there is a change in the input data
Here is an example of the input of an employee and after tracking using the library, after a few month we were able to capture the changes. 
Input: 
Corporate_ID	Title	First_Name	Last_Name	Preferred_First_Name	Secondary_Last_Name	Gender	Year_of_Birth	Age_Group	Region_of_Birth	Country_Of_Birth	Country_of_Birth_ISO_2	Country_of_Birth_ISO_3	Nationality	Nationality_ISO_2	Nationality_ISO_3	Additional_Nationality	Additional_Nationality_ISO_2	Additional_Nationality_ISO_3	Position_ID	Position_Title	Position_Start_Date	Work_Shift	Hourly_Plan_Worker	Blue_White_Collar	Function	AI_OP_Driver	ADS_OP_Driver	AH_OP_Driver	Work_Email	Band	Band_Extension	Active_Workforce_Status	Company_Service_Date	Hire_Date	Is_HRBP	Is_Manager	Local_HR_ID	Work_Mobile_Phone_Number	Original_Hire_Date	Professional_Category	Social_Category_Code	Social_Category_Description	Seniority_Date	Estimated_Employment_End_Date	Termination_Date	Termination_Reason	Local_Termination_Reason	Worker_Status	Worker_Type	Worker_Type_Category	Location_ID	Location_Name	Location_City	Location_Region	Location_Zone	Location_Country	Location_Country_ISO_2	Location_Country_ISO_3	Is_Location_Active	Supervisory_Organisation_ID	Supervisory_Organisation_Name	Supervisory_Organisation_Siglum	Job_Profile_ID	Job_Profile_Name	Job_Family_Group	Job_Family	Job_Category	Job_Code_USA	Job_Code_Canada	HRBP_Corporate_ID	Establishment_ID	Establishment_Name	Is_Establishment_Active	Cost_Center_Code	Financial_Entity_Code	Full_Time_Equivalent_Percentage	Legacy_SAP_ID	Company_Code	Company_Name	Company_Division	Company_Division_Short_ID	Company_Country	Company_Country_ISO_2	Company_Country_ISO_3
1	125220	null	Daniel	Garmann	Daniel	null	Male	1982	40-49	null	Germany	DE	DEU	Germany	DE	DEU	null	null	null	P_508117	Senior Director Flowline	2023-01-01	Exempt Days (United States of America)	Salaried Exempt US	WC	Operations	Manage & Support	Not Assigned	Not Assigned	daniel.garmann@airbus.com	BIV	null	AWF	null	2003-08-18	false	true	018642	+1 251 295 3818	2003-08-18	null	1.1	Executive or Senior Level Officials and Managers	2003-08-18	null	null	null	null	Active	Regular	Employee	LOC_0116	Mobile, AL - FAL	Mobile, AL	Alabama	North America	United States of America	US	USA	true	O_20077	320 FAL Mobile	AAOMA	J_465	Manager & Leader <SJ-EM-EA-005>	Management <FU-FA>	Leadership <JF-FA-EM>	Overhead	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)	null	null	AX26	Airbus Americas Inc. - Mobile	true	AA10008122	1568	100	99104212	1568	Airbus Americas, Inc.	Airbus	AI	United States of America	US	USA
Output:
 Corporate_ID	Title	First_Name	Last_Name	Preferred_First_Name	Secondary_Last_Name	Gender	Year_of_Birth	Age_Group	Region_of_Birth	Country_Of_Birth	Country_of_Birth_ISO_2	Country_of_Birth_ISO_3	Nationality	Nationality_ISO_2	Nationality_ISO_3	Additional_Nationality	Additional_Nationality_ISO_2	Additional_Nationality_ISO_3	Position_ID	Position_Title	Position_Start_Date	Work_Shift	Hourly_Plan_Worker	Blue_White_Collar	Function	AI_OP_Driver	ADS_OP_Driver	AH_OP_Driver	Work_Email	Band	Band_Extension	Active_Workforce_Status	Company_Service_Date	Hire_Date	Is_HRBP	Is_Manager	Local_HR_ID	Work_Mobile_Phone_Number	Original_Hire_Date	Professional_Category	Social_Category_Code	Social_Category_Description	Seniority_Date	Estimated_Employment_End_Date	Termination_Date	Termination_Reason	Local_Termination_Reason	Worker_Status	Worker_Type	Worker_Type_Category	Location_ID	Location_Name	Location_City	Location_Region	Location_Zone	Location_Country	Location_Country_ISO_2	Location_Country_ISO_3	Is_Location_Active	Supervisory_Organisation_ID	Supervisory_Organisation_Name	Supervisory_Organisation_Siglum	Job_Profile_ID	Job_Profile_Name	Job_Family_Group	Job_Family	Job_Category	Job_Code_USA	HRBP_Corporate_ID	Establishment_ID	Establishment_Name	Is_Establishment_Active	Cost_Center_Code	Financial_Entity_Code	Full_Time_Equivalent_Percentage	Legacy_SAP_ID	Company_Code	Company_Name	Company_Division	Company_Division_Short_ID	Company_Country	Company_Country_ISO_2	Company_Country_ISO_3	idHash	trackingHash	valid_from	valid_to	current_version
1	125220	null	Daniel	Garmann	Daniel	null	Male	1982	40-49	null	Germany	DE	DEU	Germany	DE	DEU	null	null	null	P_508117	Senior Director Flowline	2023-01-01	Exempt Days (United States of America)	Salaried Exempt US	WC	Operations	Manage & Support	Not Assigned	Not Assigned	daniel.garmann@airbus.com	BIV	null	AWF	null	2003-08-18	false	true	018642	+1 251 295 3818	2003-08-18	null	1.1	Executive or Senior Level Officials and Managers	2003-08-18	null	null	null	null	Active	Regular	Employee	LOC_0116	Mobile, AL - FAL	Mobile, AL	Alabama	North America	United States of America	US	USA	true	O_27257	Single Aisle A320 Ramp Up	AAOMU	J_465	Manager & Leader <SJ-EM-EA-005>	Management <FU-FA>	Leadership <JF-FA-EM>	Overhead	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)	null	AX26	Airbus Americas Inc. - Mobile	true	AA10008184	1568	100	99104212	1568	Airbus Americas, Inc.	Airbus	AI	United States of America	US	USA	125220	Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_27257_!#!_Single Aisle A320 Ramp Up_!#!_AAOMU_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-03	2025-06-11	false
2	125220	null	Daniel	Garmann	Daniel	null	Male	1982	40-49	null	Germany	DE	DEU	Germany	DE	DEU	null	null	null	P_508117	Senior Director Flowline	2023-01-01	Exempt Days (United States of America)	Salaried Exempt US	WC	Operations	Manage & Support	Not Assigned	Not Assigned	daniel.garmann@airbus.com	BIV	null	AWF	null	2003-08-18	false	true	018642	+1 251 295 3818	2003-08-18	null	1.1	Executive or Senior Level Officials and Managers	2003-08-18	null	null	null	null	Active	Regular	Employee	LOC_0116	Mobile, AL - FAL	Mobile, AL	Alabama	North America	United States of America	US	USA	true	O_20077	320 FAL Mobile	AAOMA	J_465	Manager & Leader <SJ-EM-EA-005>	Management <FU-FA>	Leadership <JF-FA-EM>	Overhead	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)	null	AX26	Airbus Americas Inc. - Mobile	true	AA10008184	1568	100	99104212	1568	Airbus Americas, Inc.	Airbus	AI	United States of America	US	USA	125220	Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-12	2025-07-11	false
3	125220	null	Daniel	Garmann	Daniel	null	Male	1982	40-49	null	Germany	DE	DEU	Germany	DE	DEU	null	null	null	P_508117	Senior Director Flowline	2023-01-01	Exempt Days (United States of America)	Salaried Exempt US	WC	Operations	Manage & Support	Not Assigned	Not Assigned	daniel.garmann@airbus.com	BIV	null	AWF	null	2003-08-18	false	true	018642	+1 251 295 3818	2003-08-18	null	1.1	Executive or Senior Level Officials and Managers	2003-08-18	null	null	null	null	Active	Regular	Employee	LOC_0116	Mobile, AL - FAL	Mobile, AL	Alabama	North America	United States of America	US	USA	true	O_20077	320 FAL Mobile	AAOMA	J_465	Manager & Leader <SJ-EM-EA-005>	Management <FU-FA>	Leadership <JF-FA-EM>	Overhead	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)	null	AX26	Airbus Americas Inc. - Mobile	true	AA10008122	1568	100	99104212	1568	Airbus Americas, Inc.	Airbus	AI	United States of America	US	USA	125220	Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008122_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-07-12	2025-11-18	true


Here is something I want to expand for the logic: 
I want to have another column called “Note” after the column “current_version”
Here are conditions for the Note column:
– For the first initialization, the Note should specify each record as Original or First version (or you can suggest better name) 
– When new changes are captured, we should note in the “Note” column as “Change: Position Title/Job_Code/…” I mean basically Change: the field that is changed 
The second improvement is important. In the future, we might have new fields coming. However, currently with those functions/libraries, we can only capture the fields that we first initialize. This means in the first initialization, we have 85 columns. However, when we have one more column, that column can’t be included in the output for tracking as it would break the schema. That’s why in the usage I need to drop the Job Code Canada, this Job Code Canada appears after the initialization. 
This requires us to create a new dataset for either tracking that field or create the entire new tracking and our previous tracking might be waste. 
Thus, I want you to think about the way to tweak those libraries/functions, so that when new fields are added to the input dataset, we can also add the fields in which mean expand the schema. 

For example, 
Corporate_ID	Title	First_Name	Last_Name	Job_Profile_Name	Job_Code_USA
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>  AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)
After using the library for a few months, we got: 
 Corporate_ID	Title	First_Name	Last_Name	Job_Profile_Name	Job_Code_USA	idHash	trackingHash	valid_from	valid_to	current_version
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America) Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_27257_!#!_Single Aisle A320 Ramp Up_!#!_AAOMU_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-03	2025-06-11	false
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America) Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-12	2025-07-11	false
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)
Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008122_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-07-12	2025-11-18	true
This is how we want the result look like when new fields come, 
For example, when new field come, the input become:
Corporate_ID	Title	First_Name	Last_Name	Job_Profile_Name	Job_Code_USA Training_Satisfied
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>  AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)  yes
Then the expected output now be (adding new Note column I want also):
 Corporate_ID	Title	First_Name	Last_Name	Job_Profile_Name	Job_Code_USA Training_Satisfied	idHash	trackingHash	valid_from	valid_to	current_version Note
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)  nullDaniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_27257_!#!_Single Aisle A320 Ramp Up_!#!_AAOMU_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-03	2025-06-11	false    First Version
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)  null   Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008184_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-06-12	2025-07-11	false    Changed: Supervisory_Organization Siglum
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America) null   Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008122_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-07-12	2025-11-18	false  Changed: ….
125220	null	Daniel	Garmann	Manager & Leader <SJ-EM-EA-005>	AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)   yes  Daniel_!#!_Garmann_!#!_Daniel_!#!_Male_!#!_1982_!#!_40-49_!#!_Germany_!#!_DE_!#!_DEU_!#!_Germany_!#!_DE_!#!_DEU_!#!_P_508117_!#!_Senior Director Flowline_!#!_2023-01-01_!#!_Exempt Days (United States of America)_!#!_Salaried Exempt US_!#!_WC_!#!_Operations_!#!_Manage & Support_!#!_Not Assigned_!#!_Not Assigned_!#!_daniel.garmann@airbus.com_!#!_BIV_!#!_AWF_!#!_2003-08-18_!#!_false_!#!_true_!#!_018642_!#!_+1 251 295 3818_!#!_2003-08-18_!#!_1.1_!#!_Executive or Senior Level Officials and Managers_!#!_2003-08-18_!#!_Active_!#!_Regular_!#!_Employee_!#!_LOC_0116_!#!_Mobile, AL - FAL_!#!_Mobile, AL_!#!_Alabama_!#!_North America_!#!_United States of America_!#!_US_!#!_USA_!#!_true_!#!_O_20077_!#!_320 FAL Mobile_!#!_AAOMA_!#!_J_465_!#!_Manager & Leader <SJ-EM-EA-005>_!#!_Management <FU-FA>_!#!_Leadership <JF-FA-EM>_!#!_Overhead_!#!_AAI - F9FB4A - Sr Director, Flowline - (USA - Job Code-United States of America)_!#!_AX26_!#!_Airbus Americas Inc. - Mobile_!#!_true_!#!_AA10008122_!#!_1568_!#!_100_!#!_99104212_!#!_1568_!#!_Airbus Americas, Inc._!#!_Airbus_!#!_AI_!#!_United States of America_!#!_US_!#!_USA	2025-07-12	2025-11-18	true  Second Version
Okay, can you see the update here? 
The update included: 
Previous records don’t have Training Satisfied are now expand in which the values are set to “null”. The Note columns would reflect the first version (first initialization), the other record reflect the changes and what changes. The record in which is the current version would reflect the value of the new added fields and it would be denoted as “Second Version” in the Note column. This logic hold when new fields come (given that we don’t know how many field would be added and when they would be added), thus please prepare a structure way to implement this. 
Could you please create advanced version of the library and update the usage so that we can track the changes when new fields come? 
I detect that set_mode(“replace”) likely prevent that schema change. We would still need to use it to make the incremental works well. You can either find a better way or use set_mode(“replace”) in a smarter way 
Please help me to implement this
